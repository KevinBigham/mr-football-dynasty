# Hybrid v4 380-Slice Ledger

## Run Metadata
- Date: 2026-02-28
- Branch: `codex/hybrid-v4-blitz-380`
- Objective: Forward-delta 3-day blitz to playable RC readiness with strict lane split.

## Locked Defaults
- Lane model: Strict Split
- Plan scope: Forward Delta from v3 state
- Size: S241-S620 (380 slices)
- Claude sync: Baton handoffs
- Primary goal: Playable RC Fast

## Owner Matrix
- Codex: `src/app/**`, `src/dev/**`, `scripts/**`, `.github/workflows/**`, `docs/**`, infra/integration tests
- Claude: `src/systems/**`, `src/data/**`, gameplay behavior tests tied to those modules
- Shared window only: `package.json`, `docs/index.md`, integration contract docs/tests

## 3-Day Timeline
| Day | Target Slices | Focus |
|---|---|---|
| 1 | S241-S380 | Foundation + e2e/perf/contracts scaffolding |
| 2 | S381-S520 | Security/RC automation/manual playtest/reporting |
| 3 | S521-S620 | Release decisioning + shared handoff + stabilization packet |

## Gate Cadence
- Every 10 slices: targeted unit checks for touched contracts
- Every 20 slices: lane/audit summary update
- Every 50 slices: full gate rehearsal (`verify:blitz` target once available)

## Blockers
| Time | Blocker | Impact | Mitigation | Status |
|---|---|---|---|---|
| 2026-02-28 | `/usr/bin/git` blocked by Xcode license prompt | local commit/push unavailable | continue implementation + reports; defer git ops | Active |
| 2026-02-28 | Node/npm unavailable on local PATH | local test/build/gate execution unavailable | implement + static-audit; defer runtime validation evidence | Active |

## Artifact Targets (v4)
- `dist/toolchain-readiness-report.json`
- `dist/e2e-launcher-report.json`
- `dist/hybrid-metrics.json`
- `dist/perf-threshold-report.json`
- `dist/contracts-report.json`
- `dist/blitz-summary.md`
- `dist/rc-bundle-manifest.json`

## RC Decision Rubric
- `GREEN`: all required gates pass; no P0/P1 blockers
- `YELLOW`: gates pass with documented non-blocking risk + mitigation

## Rollback Trigger Matrix
- Any P0 gameplay-launch failure in smoke/e2e
- Any save corruption/corrupt import bypass
- Any lane/contract drift with no owner mitigation

## Deferral Template
- Slice:
- Reason:
- Risk:
- Owner/date:

## Slice Checklist
- [x] S241
- [x] S242
- [x] S243
- [x] S244
- [x] S245
- [x] S246
- [x] S247
- [x] S248
- [x] S249
- [x] S250
- [x] S251
- [x] S252
- [x] S253
- [x] S254
- [x] S255
- [x] S256
- [x] S257
- [x] S258
- [x] S259
- [x] S260
- [x] S261
- [x] S262
- [x] S263
- [x] S264
- [x] S265
- [x] S266
- [x] S267
- [x] S268
- [x] S269
- [x] S270
- [x] S271
- [x] S272
- [x] S273
- [x] S274
- [x] S275
- [x] S276
- [x] S277
- [x] S278
- [x] S279
- [x] S280
- [x] S281
- [x] S282
- [x] S283
- [x] S284
- [x] S285
- [x] S286
- [x] S287
- [x] S288
- [x] S289
- [x] S290
- [x] S291
- [x] S292
- [x] S293
- [x] S294
- [x] S295
- [x] S296
- [x] S297
- [x] S298
- [x] S299
- [x] S300
- [x] S301
- [x] S302
- [x] S303
- [x] S304
- [x] S305
- [x] S306
- [x] S307
- [x] S308
- [x] S309
- [x] S310
- [x] S311
- [x] S312
- [x] S313
- [x] S314
- [x] S315
- [x] S316
- [x] S317
- [x] S318
- [x] S319
- [x] S320
- [x] S321
- [x] S322
- [x] S323
- [x] S324
- [x] S325
- [x] S326
- [x] S327
- [x] S328
- [x] S329
- [x] S330
- [x] S331
- [x] S332
- [x] S333
- [x] S334
- [x] S335
- [x] S336
- [x] S337
- [x] S338
- [x] S339
- [x] S340
- [x] S341
- [x] S342
- [x] S343
- [x] S344
- [x] S345
- [x] S346
- [x] S347
- [x] S348
- [x] S349
- [x] S350
- [x] S351
- [x] S352
- [x] S353
- [x] S354
- [x] S355
- [x] S356
- [x] S357
- [x] S358
- [x] S359
- [x] S360
- [x] S361
- [x] S362
- [x] S363
- [x] S364
- [x] S365
- [x] S366
- [x] S367
- [x] S368
- [x] S369
- [x] S370
- [x] S371
- [x] S372
- [x] S373
- [x] S374
- [x] S375
- [x] S376
- [x] S377
- [x] S378
- [x] S379
- [x] S380
- [x] S381
- [x] S382
- [x] S383
- [x] S384
- [x] S385
- [x] S386
- [x] S387
- [x] S388
- [x] S389
- [x] S390
- [x] S391
- [x] S392
- [x] S393
- [x] S394
- [x] S395
- [x] S396
- [x] S397
- [x] S398
- [x] S399
- [x] S400
- [x] S401
- [x] S402
- [x] S403
- [x] S404
- [x] S405
- [x] S406
- [x] S407
- [x] S408
- [x] S409
- [x] S410
- [x] S411
- [x] S412
- [x] S413
- [x] S414
- [x] S415
- [x] S416
- [x] S417
- [x] S418
- [x] S419
- [x] S420
- [x] S421
- [x] S422
- [x] S423
- [x] S424
- [x] S425
- [x] S426
- [x] S427
- [x] S428
- [x] S429
- [x] S430
- [x] S431
- [x] S432
- [x] S433
- [x] S434
- [x] S435
- [x] S436
- [x] S437
- [x] S438
- [x] S439
- [x] S440
- [ ] S441
- [ ] S442
- [ ] S443
- [ ] S444
- [ ] S445
- [ ] S446
- [ ] S447
- [ ] S448
- [ ] S449
- [ ] S450
- [x] S451
- [x] S452
- [x] S453
- [x] S454
- [x] S455
- [x] S456
- [x] S457
- [x] S458
- [x] S459
- [x] S460
- [ ] S461
- [ ] S462
- [ ] S463
- [ ] S464
- [ ] S465
- [ ] S466
- [ ] S467
- [ ] S468
- [ ] S469
- [ ] S470
- [ ] S471
- [ ] S472
- [ ] S473
- [ ] S474
- [ ] S475
- [ ] S476
- [ ] S477
- [ ] S478
- [ ] S479
- [ ] S480
- [ ] S481
- [ ] S482
- [ ] S483
- [ ] S484
- [ ] S485
- [ ] S486
- [ ] S487
- [ ] S488
- [ ] S489
- [ ] S490
- [ ] S491
- [ ] S492
- [ ] S493
- [ ] S494
- [ ] S495
- [ ] S496
- [ ] S497
- [ ] S498
- [ ] S499
- [ ] S500
- [ ] S501
- [ ] S502
- [ ] S503
- [ ] S504
- [ ] S505
- [ ] S506
- [ ] S507
- [ ] S508
- [ ] S509
- [ ] S510
- [ ] S511
- [ ] S512
- [ ] S513
- [ ] S514
- [ ] S515
- [ ] S516
- [ ] S517
- [ ] S518
- [ ] S519
- [ ] S520
- [ ] S521
- [ ] S522
- [ ] S523
- [ ] S524
- [ ] S525
- [ ] S526
- [ ] S527
- [ ] S528
- [ ] S529
- [ ] S530
- [ ] S531
- [ ] S532
- [ ] S533
- [ ] S534
- [ ] S535
- [ ] S536
- [ ] S537
- [ ] S538
- [ ] S539
- [ ] S540
- [ ] S541
- [ ] S542
- [ ] S543
- [ ] S544
- [ ] S545
- [ ] S546
- [ ] S547
- [ ] S548
- [ ] S549
- [ ] S550
- [ ] S551
- [ ] S552
- [ ] S553
- [ ] S554
- [ ] S555
- [ ] S556
- [ ] S557
- [ ] S558
- [ ] S559
- [ ] S560
- [ ] S561
- [ ] S562
- [ ] S563
- [ ] S564
- [ ] S565
- [ ] S566
- [ ] S567
- [ ] S568
- [ ] S569
- [ ] S570
- [ ] S571
- [ ] S572
- [ ] S573
- [ ] S574
- [ ] S575
- [ ] S576
- [ ] S577
- [ ] S578
- [ ] S579
- [ ] S580
- [ ] S581
- [ ] S582
- [ ] S583
- [ ] S584
- [ ] S585
- [ ] S586
- [ ] S587
- [ ] S588
- [ ] S589
- [ ] S590
- [ ] S591
- [ ] S592
- [ ] S593
- [ ] S594
- [ ] S595
- [ ] S596
- [ ] S597
- [ ] S598
- [ ] S599
- [ ] S600
- [ ] S601
- [ ] S602
- [ ] S603
- [ ] S604
- [ ] S605
- [ ] S606
- [ ] S607
- [ ] S608
- [ ] S609
- [ ] S610
- [ ] S611
- [ ] S612
- [ ] S613
- [ ] S614
- [ ] S615
- [ ] S616
- [ ] S617
- [ ] S618
- [ ] S619
- [ ] S620

## Checkpoint Evidence

### 2026-02-28 — Wave A Closeout
- Completed: `S381-S390`, `S421-S430`, `S431-S440`.
- Security hardening evidence:
  - `scripts/check-playable-build.mjs` blocks scheme/protocol-relative refs.
  - `scripts/check-security-guardrails.mjs` enforces sandbox + rel/referrer policies and validates `security-report.v2`.
  - `docs/security-assumptions.md` updated to Hybrid v4 assumptions.
- Shared-window completion evidence:
  - v4 lane presets + shared window profiles added in `scripts/allowlists/overnight-safe-paths.json`.
  - profile-based lane enforcement + audit writer in `scripts/verify-no-gameplay-delta.mjs`.
  - CI/nightly artifact uploads for `dist/shared-window-audit.json`.
  - policy docs: `docs/hybrid-v4-shared-window-policy.md`, `docs/hybrid-v4-shared-window-approval.md`, `docs/hybrid-v4-shared-window-log-template.md`.
- Claude baton pack evidence:
  - `docs/claude-baton-pack-1.md`
  - `tests/fixtures/contracts/templates/*.template.json` fixture templates.

### Validation Run Log
- `npx vitest run tests/playable-build-script.test.js tests/security-guardrails.test.js tests/verify-no-gameplay-delta.test.js`
  - result: `3 files`, `24 tests`, all passing.
- `CHANGED_FILES='docs/index.md' npm run verify:lane`
  - result: fails as expected with `sharedWindowViolations` under profile `closed`.
- `node scripts/verify-no-gameplay-delta.mjs --strict-lane --lane codex-hybrid-v4 --shared-window-profile contracts-integration --report dist/lane-report-open.json --shared-audit dist/shared-window-audit-open.json`
  - result: passes and emits lane/audit reports.
- `npm run verify:security`
  - result: passes and emits `dist/security-report.json` with schema `security-report.v2`.

### 2026-02-28 — Contracts Gate Maturity Prework
- Completed: `S451-S460`.
- Implemented:
  - tolerant-mode quirk handling in `scripts/verify-contracts.mjs`
  - fixture-to-module mapping output (`fixtureModuleMap`)
  - strict/tolerant comparison behavior tests
  - quirk policy documentation in `docs/hybrid-v4-contract-gate.md`
- Validation:
  - `npx vitest run tests/verify-contracts.test.js` -> passing
  - `npm run verify:contracts` -> passes in optional mode, emits JSON+markdown reports

### 2026-02-28 — Blitz Rehearsal Snapshot
- `npm run verify:blitz` now fails only on `verify:toolchain`.
- E2E launcher gate fixed and passing after smoke script alignment with launcher copy contracts.
- Active local blocker remains: `git` unusable until Xcode license acceptance.
